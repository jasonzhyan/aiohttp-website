{% extends '__base__.html' %}

{% block title %}manage comments{% endblock %}

{% block content %}
    <div id="loading" class="uk-width-1-1">
        <span><i class="uk-icon-spinner uk-icon-medium uk-icon-spin"></i>Loading...</span>
    </div>
    
    <h3>Manage the Comments</h3>    
    
    <div id="vm" class="uk-width-1-1">
        <div >
            <form >
                <table class="uk-table uk-table-hover">
                    <h3 class="uk-table-header">Comments:</h3>
                    <thead>
                        <th class="uk-width-2-10">User Name</th>
                        <th class="uk-width-6-10">Content</th>                        
                        <th class="uk-width-2-10">Operation</th>
                    </thead>
                    <tbody>
                        
                            <tr v-for="comment in comments">
                                <td><span v-html="comment.user_name"></span</td>
                                <td><span v-html="comment.content"></span</td>
                                
                                <td>
                                    <span ><a href="#" v-on:click.prevent="del(comment)"><i class="uk-icon-minus-square"></i> delete</a>&nbsp;&nbsp;&nbsp;</span>
                                    <span ><a href="#" v-on:click.prevent="edit(comment)"><i class="uk-icon-edit"></i>  Edit</a></span>
                                        
                                </td>
                                
                            </tr>
                           
                    </tbody>            
                   
                </table>
                <div class="uk-row">
                        <input v-model="comments" type="text">
                    </div>
                    
                <div class="uk-row">
                        <input v-model="comment1" type="text">
                    </div>    
            </form> 
        </div>
    </div>
    
    
    
    
{% endblock %}

{% block endforjs %}
<script>
var coms=null;
var data={
        comments: coms,
        comment1: null
        
    };
getJSON('/api/comments',{page: 1 },function(err,result){
    if(err){
        return fatal(err);//report err , but where it from
    }else{
        $('#loading').hide();
        com=result['comments'];
        data['comments']=com;
    }
});

alert(coms);



data.comments=coms;
//data['comment1']=comments[0];
var vm = new Vue({
    el: '#vm',
    data: data,
    methods:{
        edit: function(comment){
            
                alert('editing '+comment.content);
            
        },
        del: function(comment){
            if (confirm('确认要删除“' + comment.content + '”？删除后不可恢复！')){
                alert(comment.content+' deleted');
            }else{
                alert(comment.content+" not deleted ");
            }
        }
    }
});    


</script>
{% endblock %}
